# SBUS Receiver Test Tool

ะัะพะตะบั ะดะปั ัะตััะธัะพะฒะฐะฝะธั ะธ ะพัะปะฐะดะบะธ SBUS ะฟัะธะตะผะฝะธะบะฐ ะฝะฐ ESP32-S3.

## ๐ ะะฟะธัะฐะฝะธะต

ะญัะพั ะฟัะพะตะบั ะฒัะฒะพะดะธั ะฒ ะบะพะฝัะพะปั ะฒัะต 18 ะบะฐะฝะฐะปะพะฒ SBUS ะฟัะธะตะผะฝะธะบะฐ ะฒ ัะตะฐะปัะฝะพะผ ะฒัะตะผะตะฝะธ ั ะบัะฐัะธะฒัะผ ัะพัะผะฐัะธัะพะฒะฐะฝะธะตะผ, ััะฐัะธััะธะบะพะน ะธ ัะฒะตัะฝัะผ ะฒัะฒะพะดะพะผ.

## ๐ ะะพะดะบะปััะตะฝะธะต

```
SBUS ะัะธะตะผะฝะธะบ โ ESP32-S3 DevKit C1
    +5V        โ 5V
    GND        โ GND
    SBUS       โ GPIO41 (RX1 ะฝะฐ Serial1)
```

**ะกะพะณะปะฐัะฝะพ ะบะพะดั ะะตะฝะณะต (lesson7_RollCtrl):**
- ะัะฟะพะปัะทัะตััั **Serial1** (ะฝะต Serial2!)
- RX ะฟะธะฝ: **GPIO41**
- TX ะฟะธะฝ: ะฝะต ะธัะฟะพะปัะทัะตััั (-1)

**ะะะะะ:**
- ะฃะฑะตะดะธัะตัั ััะพ ะฟัะธะตะผะฝะธะบ ะฝะฐัััะพะตะฝ ะฒ ัะตะถะธะผ **SBUS** (ะฝะต PPM/iBUS)
- ะะบะปััะธัะต ะฟะตัะตะดะฐััะธะบ **ะฟะตัะตะด** ะทะฐะณััะทะบะพะน ะฟัะพัะธะฒะบะธ
- ะะปั FrSky ะฟัะธะตะผะฝะธะบะพะฒ ะฟัะพะฒะพะด ะพะฑััะฝะพ ะฝะฐะทัะฒะฐะตััั "SBUS"
- ะะปั FlySky ะฝัะถะตะฝ ะฟัะธะตะผะฝะธะบ ั ะฟะพะดะดะตัะถะบะพะน SBUS (ะฝะพะฒัะต ะผะพะดะตะปะธ)

## ๐ ะัััััะน ััะฐัั

1. **ะัะบัะพะนัะต ะฟัะพะตะบั ะฒ PlatformIO:**
   ```bash
   cd firmware/receiver_test
   pio run
   ```

2. **ะะฐะณััะทะธัะต ะฝะฐ ESP32-S3:**
   ```bash
   pio run -t upload
   ```

3. **ะัะบัะพะนัะต Serial Monitor:**
   ```bash
   pio device monitor
   ```
   ะะปะธ ะฒ VS Code: `PlatformIO: Serial Monitor`

## ๐ ะงัะพ ะพัะพะฑัะฐะถะฐะตััั

### ะัะฝะพะฒะฝะฐั ะธะฝัะพัะผะฐัะธั:
- **16 ะฐะฝะฐะปะพะณะพะฒัั ะบะฐะฝะฐะปะพะฒ** (CH1-CH16):
  - ะกััะพะต ะทะฝะฐัะตะฝะธะต SBUS (172-1811)
  - ะะพัะผะฐะปะธะทะพะฒะฐะฝะฝะพะต ะทะฝะฐัะตะฝะธะต (-100% ะดะพ +100%)
  - ะะฝะฐัะตะฝะธะต ะฒ ะผะธะบัะพัะตะบัะฝะดะฐั PWM (1000-2000 ฮผs)
  - ะัะพะณัะตัั-ะฑะฐั ะดะปั ะฒะธะทัะฐะปะธะทะฐัะธะธ
  
- **2 ะดะธัะบัะตัะฝัั ะบะฐะฝะฐะปะฐ** (CH17, CH18):
  - ON/OFF ัะพััะพัะฝะธะต

### ะกัะฐััั ัะฒัะทะธ:
- **Lost Frame** - ะฟะพัะตัั ะบะฐะดัะฐ
- **Failsafe** - ัะตะถะธะผ failsafe ะฐะบัะธะฒะตะฝ

### ะกัะฐัะธััะธะบะฐ:
- ะะฑัะตะต ะบะพะปะธัะตััะฒะพ ะฟัะธะฝัััั ะฟะฐะบะตัะพะฒ
- ะะพะปะธัะตััะฒะพ ะฟะพัะตััะฝะฝัั ะบะฐะดัะพะฒ
- ะะพะปะธัะตััะฒะพ ัะพะฑััะธะน failsafe
- ะงะฐััะพัะฐ ะพะฑะฝะพะฒะปะตะฝะธั (ะฟะฐะบะตัะพะฒ ะฒ ัะตะบัะฝะดั)
- ะัะตะผั ั ะผะพะผะตะฝัะฐ ะฟะพัะปะตะดะฝะตะณะพ ะฟะฐะบะตัะฐ
- Uptime ัะธััะตะผั

## โ๏ธ ะะฐัััะพะนะบะฐ

ะัะต ะฝะฐัััะพะนะบะธ ะฒ ัะฐะนะปะต `include/config.h`:

```cpp
// ะะธะฝั ะฟะพะดะบะปััะตะฝะธั
#define SBUS_RX_PIN 16  // RX ะฟะธะฝ
#define SBUS_TX_PIN 17  // TX ะฟะธะฝ (ะฝะต ะธัะฟะพะปัะทัะตััั)

// ะงะฐััะพัะฐ ะพะฑะฝะพะฒะปะตะฝะธั ะฒัะฒะพะดะฐ
#define DEBUG_PRINT_INTERVAL 100  // ะผะธะปะปะธัะตะบัะฝะด (10 Hz)

// ะคะพัะผะฐัั ะฒัะฒะพะดะฐ
#define PRINT_RAW_VALUES    true   // ะกัััะต ะทะฝะฐัะตะฝะธั (172-1811)
#define PRINT_NORMALIZED    true   // ะัะพัะตะฝัั (-100% ะดะพ +100%)
#define PRINT_MICROSECONDS  false  // PWM ะผะธะบัะพัะตะบัะฝะดั (1000-2000)

// ะฆะฒะตัะฝะพะน ะฒัะฒะพะด
#define USE_COLOR_OUTPUT    true

// ะัััะฒะฐั ะทะพะฝะฐ ะดะถะพะนััะธะบะฐ
#define STICK_DEADZONE 30  // ยฑ30 (~1.5%)
```

## ๐จ ะฆะฒะตัะพะฒะฐั ะธะฝะดะธะบะฐัะธั

- ๐ข **ะะตะปัะฝัะน** - ะทะฝะฐัะตะฝะธะต > 50%
- ๐ด **ะัะฐัะฝัะน** - ะทะฝะฐัะตะฝะธะต < -50%
- ๐ต **ะกะธะฝะธะน** - ะทะฝะฐัะตะฝะธะต ะพะบะพะปะพ ัะตะฝััะฐ (ยฑ5%)
- ๐ก **ะัะปััะน** - ะฟัะพะผะตะถััะพัะฝัะต ะทะฝะฐัะตะฝะธั

## ๐๏ธ ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผ

### ะะตั ะดะฐะฝะฝัั ะพั ะฟัะธะตะผะฝะธะบะฐ
1. ะัะพะฒะตัััะต ััะพ ะฟะตัะตะดะฐััะธะบ ะฒะบะปััะตะฝ ะธ ะฒ ะทะพะฝะต ะดะตะนััะฒะธั
2. ะัะพะฒะตัััะต ััะพ ะฟัะธะตะผะฝะธะบ ัะฒัะทะฐะฝ (bind) ั ะฟะตัะตะดะฐััะธะบะพะผ
3. ะฃะฑะตะดะธัะตัั ััะพ ะฟัะธะตะผะฝะธะบ ะฒ ัะตะถะธะผะต SBUS (ะฝะต PPM!)
4. ะัะพะฒะตัััะต ะฟะพะดะบะปััะตะฝะธะต ะฟัะพะฒะพะดะพะฒ
5. ะะพะฟัะพะฑัะนัะต ะดััะณะพะน ะฟะธะฝ (ะธะทะผะตะฝะธัะต `SBUS_RX_PIN` ะฒ config.h)

### ะกััะฐะฝะฝัะต ะทะฝะฐัะตะฝะธั
1. ะะพะทะผะพะถะฝะพ ะฟัะธะตะผะฝะธะบ ะฒ ัะตะถะธะผะต ะธะฝะฒะตััะธะธ - ะฟะพะฟัะพะฑัะนัะต ะดััะณะพะน ัะตะถะธะผ ะฝะฐ ะฟัะธะตะผะฝะธะบะต
2. ะัะพะฒะตัััะต ััะพ ะธัะฟะพะปัะทัะตััั ะฑะธะฑะปะธะพัะตะบะฐ SBUS (ะฝะต PPM)
3. ะะฐะปะธะฑััะนัะต ััะธะบะธ ะฝะฐ ะฟะตัะตะดะฐััะธะบะต

### ะะพััะพัะฝะฝัะน Failsafe
1. ะะตัะตะดะฐััะธะบ ะฒัะบะปััะตะฝ ะธะปะธ ะฒะฝะต ะทะพะฝั
2. ะัะธะตะผะฝะธะบ ะฝะต ัะฒัะทะฐะฝ ั ะฟะตัะตะดะฐััะธะบะพะผ
3. ะะปะพัะฐั ะฐะฝัะตะฝะฝะฐ ะฟัะธะตะผะฝะธะบะฐ

## ๐ ะัะธะผะตัั ะธัะฟะพะปัะทะพะฒะฐะฝะธั

### ะะฐะทะพะฒัะน ัะตัั
ะัะพััะพ ะทะฐะณััะทะธัะต ะฟัะพัะธะฒะบั ะธ ะพัะบัะพะนัะต Serial Monitor. ะั ัะฒะธะดะธัะต ัะฐะฑะปะธัั ัะพ ะฒัะตะผะธ ะบะฐะฝะฐะปะฐะผะธ.

### ะะฐะปะธะฑัะพะฒะบะฐ ะฟะตัะตะดะฐััะธะบะฐ
1. ะะตัะตะผะตััะธัะต ะฒัะต ััะธะบะธ ะฒ ัะตะฝัั - ะดะพะปะถะฝั ะฟะพะบะฐะทัะฒะฐัั ~0%
2. ะะตัะตะผะตััะธัะต ััะธะบ ะฒะฒะตัั/ะฒะฟัะฐะฒะพ - ะดะพะปะถะตะฝ ะฟะพะบะฐะทัะฒะฐัั ~+100%
3. ะะตัะตะผะตััะธัะต ััะธะบ ะฒะฝะธะท/ะฒะปะตะฒะพ - ะดะพะปะถะตะฝ ะฟะพะบะฐะทัะฒะฐัั ~-100%

### ะัะพะฒะตัะบะฐ ะฝะฐะทะฝะฐัะตะฝะธั ะบะฐะฝะฐะปะพะฒ
ะะฒะธะณะฐะนัะต ะบะฐะถะดัะน ัะปะตะผะตะฝั ัะฟัะฐะฒะปะตะฝะธั ะฝะฐ ะฟะตัะตะดะฐััะธะบะต ะฟะพ ะพัะตัะตะดะธ ะธ ัะผะพััะธัะต ะบะฐะบะพะน ะบะฐะฝะฐะป ะผะตะฝัะตััั:
- ะะฑััะฝะพ CH1 = Aileron (ะบัะตะฝ)
- CH2 = Elevator (ัะฐะฝะณะฐะถ)
- CH3 = Throttle (ะณะฐะท)
- CH4 = Rudder (ัััะบะฐะฝะธะต)

## ๐ง ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ

- **ะัะพัะพะบะพะป:** SBUS (Futaba)
- **ะกะบะพัะพััั:** 100000 baud, 8E2
- **ะงะฐััะพัะฐ ะพะฑะฝะพะฒะปะตะฝะธั:** ~9ms (~110 Hz)
- **ะะธะฐะฟะฐะทะพะฝ ะทะฝะฐัะตะฝะธะน:** 172-1811 (11 ะฑะธั)
- **ะะฝะฒะตััะธั:** ะะฒัะพะผะฐัะธัะตัะบะฐั (ESP32 UART)

## ๐ ะะพะฟะพะปะฝะธัะตะปัะฝะฐั ะธะฝัะพัะผะฐัะธั

ะกะผ. ัะฐะบะถะต:
- `firmware/PPM_vs_SBUS.md` - ััะฐะฒะฝะตะฝะธะต ะฟัะพัะพะบะพะปะพะฒ
- `firmware/main_controller/lib/SBUS/` - ะฑะธะฑะปะธะพัะตะบะฐ SBUS

## ๐ ะะธัะตะฝะทะธั

MIT License - ะธัะฟะพะปัะทัะนัะต ัะฒะพะฑะพะดะฝะพ!
